---
title: "p8105_hw3_ab6168"
author: "Angelica Bailey"
date: "2025-10-06"
output: github_document
---

## Problem 1

Loading instacart dataset

```{r}
library(tidyverse)
library(p8105.datasets)
data("instacart")
```

Viewing dataset

```{r}
view(instacart)
```

**Description**:

The `instacart` data set contains information on grocery orders placed in 2017 by 131,209 unique users and includes 1,384,617 observations. There are a total of 15 variables describing the details of the order, product, and customer behavior. Each row in the data set is a product from an order. Key variables include:

-   `order_id` – Unique identifier for each order

-   `user_id` - Unique customer identifier

-   `product_id` and `product_name` - Identify the specific item purchased

-   `add_to_cart_order` - The sequence in which each product was added to the cart

-   `reordered` - Indicates whether product had been purchased by the user before

-   `order_dow` and `order_hour_of_day` - Represent when the order was placed

-   `aisle` and `department` - Describe the product's category

A few observations are that
#orders purchased on day 0
```{r}
instacart |> filter(
  order_dow == 0
)
```


- How many aisles are there, and which aisles are the most items ordered from?

```{r}
#getting number of unique aisles
instacart |> summarise(n_distinct(aisle))
```

```{r}
#finding aisles with the most items ordered
instacart |> count(aisle, sort = TRUE)
```

There are **134 aisles**. Most items are ordered from the **Fresh Vegetables** and **Fresh Fruits** aisle. 


- Make a plot that shows the number of items ordered in each aisle, limiting this to aisles with more than 10000 items ordered. Arrange aisles sensibly, and organize your plot so others can read it.

```{r}
#making bar chart
instacart |> 
  count(aisle, sort = TRUE) |>  #count of items for each aisle
  filter(n > 10000) |> 
  ggplot(aes(x = aisle, y = n)) +
  geom_col(fill = "darkgreen") +
  coord_flip() +  # flip for readability
  labs(
    title = "Number of Items Ordered per Aisle (Over 10,000 Orders)",
       x = "Aisle",
       y = "Number of Items Ordered"
    )
```



- Make a table showing the three most popular items in each of the aisles “baking ingredients”, “dog food care”, and “packaged vegetables fruits”. Include the number of times each item is ordered in your table.

```{r}
knitr::kable(
  instacart |>  
  filter(aisle == c("baking ingredients", 
                      "dog food care", 
                      "packaged vegetables fruits")
         ) |> 
  count(aisle, product_name, sort = TRUE) |>  
  group_by(aisle) |>  
  slice_max(order_by = n, n = 3)
)

```


- Make a table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week; format this table for human readers (i.e. produce a 2 x 7 table).

```{r}
instacart |> 
  filter(
    product_name == c("Pink Lady Apples", "Coffee Ice Cream")) |>  
  group_by(product_name, order_dow) |>  
  summarise(
    mean_hour = round(mean(order_hour_of_day),1).  #getting mean for each day
    ) |> 
  pivot_wider(        
    names_from = order_dow, 
    values_from = mean_hour)

```


## Problem 2

```{r}
zori_df =
  read_csv("data/zori_NYC.csv") |> 
  select(-StateName, -State, -City, -Metro, - RegionType) |> 
  #renaming variables
  rename(
    region_id = "RegionID",
    size_rank = "SizeRank",
    zip_code = "RegionName",
    county = "CountyName"
    ) |> 
  mutate(
    county = str_remove(county," County")
  ) |>
  pivot_longer(
    cols = "2015-01-31":"2024-08-31",
    names_to = "date",
    values_to = "rent_price"
  )

zip_df = 
  read_csv("data/Zip Codes.csv") |> 
  janitor::clean_names() |> 
  select(-state_fips, -file_date)


join_zillow_df = 
  left_join(zori_df, zip_df, by = c("zip_code", "county")) |> 
  drop_na(rent_price)
```



There are 116 months between January 2015 and August 2024. How many ZIP codes are observed 116 times? How many are observed fewer than 10 times? Why are some ZIP codes are observed rarely and others observed in each month?

```{r}
#How many ZIP codes are observed 116 times?

join_zillow_df |> 
  count(zip_code) |> 
  filter(n == 116)
```
There are **48 zip codes** that are observed 116 times.


```{r}
#How many ZIP codes are observed fewer than 10 times?

join_zillow_df |> 
  count(zip_code) |> 
  filter(n < 10)
```

There are **26 zip codes** that are observed fewer than 10 times


Some ZIP codes are observed rarely because there is a lack of information on the rent prices for this zip codes depending on the area. There may be litte to no rent properties in certain areas.



Table showing average rental price by borough and year
```{r}
avg_rent = join_zillow_df |> 
  #separating date
  separate(date,
    into = c("year", "month","day"), sep = "-") |> 
  group_by(county, year) |> 
  summarize(average_rent = mean(rent_price))

knitr::kable(avg_rent)
```


In the Bronx, the rent was decreasing from 2015 to 2018. From 2019 to 2024, the rent increases substantially. In Kings county, the rent increases substantially from 2021 to 2024.In New York, from 2021 to 2022, the rent increases significantly. In Queens, from 2021 to 2024, the rent increases significantly.


Make a plot showing NYC Rental Prices within ZIP codes for all available years. Your plot should facilitate comparisons across boroughs.
```{r}


#Queens
queens_plot = join_zillow_df |>  
  separate(date,
           into = c("year", "month","day"), sep = "-") |> 
  filter(county == "Queens") |> 
  ggplot(aes(x = year, y = rent_price, ylim = c(0,5000))) +
  geom_point()



#Kings
kings_plot = join_zillow_df |>  
  separate(date,
           into = c("year", "month","day"), sep = "-") |> 
  filter(county == "Kings") |> 
  ggplot(aes(x = year, y = rent_price, ylim = c(0,5000))) +
  geom_point()



#Bronx
bronx_plot = join_zillow_df |>  
  separate(date,
           into = c("year", "month","day"), sep = "-") |> 
  filter(county == "Bronx") |> 
  ggplot(aes(x = year, y = rent_price, ylim = c(0,5000))) +
  geom_point()



#Richmond
rich_plot = join_zillow_df |>  
  separate(date,
           into = c("year", "month","day"), sep = "-") |> 
  filter(county == "Richmond") |> 
  ggplot(aes(x = year, y = rent_price, ylim = c(0,5000))) +
  geom_point()

```








